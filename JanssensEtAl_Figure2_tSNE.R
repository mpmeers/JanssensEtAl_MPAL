K4m3<-read.table("K4m3.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K4m3.data<-read.table("K4m3.regions.bed_counts.bed.normalized.bed", header=TRUE)
K4m3.counts<-K4m3.data[,c(4:ncol(K4m3.data))]
K4m3$cluster<-factor(K4m3$cluster)
K4m3$ALL<-apply(as.data.frame(t(t(K4m3.counts)-apply(K4m3.counts, 2, min))), 1, function(x) max(x[c(8,10:11,13)]))
K4m3$AML<-apply(as.data.frame(t(t(K4m3.counts)-apply(K4m3.counts, 2, min))), 1, function(x) max(x[c(1:4,6,9)]))
K4m3$MPAL<-apply(as.data.frame(t(t(K4m3.counts)-apply(K4m3.counts, 2, min))), 1, function(x) max(x[c(5,12)]))
K4m3$CD34<-apply(as.data.frame(t(t(K4m3.counts)-apply(K4m3.counts, 2, min))), 1, function(x) max(x[c(7)]))
K4m3.all<-ggplot(K4m3, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m3.aml<-ggplot(K4m3, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m3.mpal<-ggplot(K4m3, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m3.cd34<-ggplot(K4m3, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m3.cluster<-ggplot(K4m3, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K4m3_ALL_tsne_210607.pdf", K4m3.all, width=7.5, height=7)
ggsave("K4m3_AML_tsne_210607.pdf", K4m3.aml, width=7.5, height=7)
ggsave("K4m3_MPAL_tsne_210607.pdf", K4m3.mpal, width=7.5, height=7)
ggsave("K4m3_CD34_tsne_210607.pdf", K4m3.cd34, width=7.5, height=7)
ggsave("K4m3_clusters_tsne_210607.pdf", K4m3.cluster, width=7.5, height=7)
K4m1<-read.table("K4m1.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K4m1.data<-read.table("K4m1.regions.bed_counts.bed.normalized.bed", header=TRUE)
K4m1.counts<-K4m1.data[,c(4:ncol(K4m1.data))]
K4m1$cluster<-factor(K4m1$cluster)
K4m1$ALL<-apply(as.data.frame(t(t(K4m1.counts)-apply(K4m1.counts, 2, min))), 1, function(x) max(x[c(8,10:11,13)]))
K4m1$AML<-apply(as.data.frame(t(t(K4m1.counts)-apply(K4m1.counts, 2, min))), 1, function(x) max(x[c(1:4,6,9)]))
K4m1$MPAL<-apply(as.data.frame(t(t(K4m1.counts)-apply(K4m1.counts, 2, min))), 1, function(x) max(x[c(5,12)]))
K4m1$CD34<-apply(as.data.frame(t(t(K4m1.counts)-apply(K4m1.counts, 2, min))), 1, function(x) max(x[c(7)]))
K4m1.all<-ggplot(K4m1, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m1.aml<-ggplot(K4m1, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m1.mpal<-ggplot(K4m1, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m1.cd34<-ggplot(K4m1, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K4m1.cluster<-ggplot(K4m1, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K4m1_ALL_tsne_210607.pdf", K4m1.all, width=7.5, height=7)
ggsave("K4m1_AML_tsne_210607.pdf", K4m1.aml, width=7.5, height=7)
ggsave("K4m1_MPAL_tsne_210607.pdf", K4m1.mpal, width=7.5, height=7)
ggsave("K4m1_CD34_tsne_210607.pdf", K4m1.cd34, width=7.5, height=7)
ggsave("K4m1_clusters_tsne_210607.pdf", K4m1.cluster, width=7.5, height=7)
K27ac<-read.table("bedfiles/DJ_MLL/DAlChrE_noK562_plusnewdata_210215/K27ac.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K27ac.data<-read.table("bedfiles/DJ_MLL/DAlChrE_noK562_plusnewdata_210215/K27ac.regions.bed_counts.bed.normalized.bed", header=TRUE)
K27ac.counts<-K27ac.data[,c(4:ncol(K27ac.data))]
K27ac$cluster<-factor(K27ac$cluster)
K27ac$ALL<-apply(as.data.frame(t(t(K27ac.counts)-apply(K27ac.counts, 2, min))), 1, function(x) max(x[c(6,8:9,11)]))
K27ac$AML<-apply(as.data.frame(t(t(K27ac.counts)-apply(K27ac.counts, 2, min))), 1, function(x) max(x[c(1:2,4,7)]))
K27ac$MPAL<-apply(as.data.frame(t(t(K27ac.counts)-apply(K27ac.counts, 2, min))), 1, function(x) max(x[c(3,10)]))
K27ac$CD34<-apply(as.data.frame(t(t(K27ac.counts)-apply(K27ac.counts, 2, min))), 1, function(x) max(x[c(5)]))
K27ac.all<-ggplot(K27ac, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27ac.aml<-ggplot(K27ac, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27ac.mpal<-ggplot(K27ac, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27ac.cd34<-ggplot(K27ac, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27ac.cluster<-ggplot(K27ac, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K27ac_ALL_tsne_210607.pdf", K27ac.all, width=7.5, height=7)
ggsave("K27ac_AML_tsne_210607.pdf", K27ac.aml, width=7.5, height=7)
ggsave("K27ac_MPAL_tsne_210607.pdf", K27ac.mpal, width=7.5, height=7)
ggsave("K27ac_CD34_tsne_210607.pdf", K27ac.cd34, width=7.5, height=7)
ggsave("K27ac_clusters_tsne_210607.pdf", K27ac.cluster, width=7.5, height=7)
K27m<-read.table("K27m.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K27m.data<-read.table("K27m.regions.bed_counts.bed.normalized.bed", header=TRUE)
K27m.counts<-K27m.data[,c(4:ncol(K27m.data))]
K27m$cluster<-factor(K27m$cluster)
K27m$ALL<-apply(as.data.frame(t(t(K27m.counts)-apply(K27m.counts, 2, min))), 1, function(x) max(x[c(8,10:11,13)]))
K27m$AML<-apply(as.data.frame(t(t(K27m.counts)-apply(K27m.counts, 2, min))), 1, function(x) max(x[c(1:4,6,9)]))
K27m$MPAL<-apply(as.data.frame(t(t(K27m.counts)-apply(K27m.counts, 2, min))), 1, function(x) max(x[c(5,12)]))
K27m$CD34<-apply(as.data.frame(t(t(K27m.counts)-apply(K27m.counts, 2, min))), 1, function(x) max(x[c(7)]))
K27m.all<-ggplot(K27m, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27m.aml<-ggplot(K27m, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27m.mpal<-ggplot(K27m, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27m.cd34<-ggplot(K27m, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K27m.cluster<-ggplot(K27m, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K27m_ALL_tsne_210607.pdf", K27m.all, width=7.5, height=7)
ggsave("K27m_AML_tsne_210607.pdf", K27m.aml, width=7.5, height=7)
ggsave("K27m_MPAL_tsne_210607.pdf", K27m.mpal, width=7.5, height=7)
ggsave("K27m_CD34_tsne_210607.pdf", K27m.cd34, width=7.5, height=7)
ggsave("K27m_clusters_tsne_210607.pdf", K27m.cluster, width=7.5, height=7)
K36m<-read.table("K36m.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K36m.data<-read.table("K36m.regions.bed_counts.bed.normalized.bed", header=TRUE)
K36m.counts<-K36m.data[,c(4:ncol(K36m.data))]
K36m$cluster<-factor(K36m$cluster)
K36m$ALL<-apply(as.data.frame(t(t(K36m.counts)-apply(K36m.counts, 2, min))), 1, function(x) max(x[c(8,10:11,13)]))
K36m$AML<-apply(as.data.frame(t(t(K36m.counts)-apply(K36m.counts, 2, min))), 1, function(x) max(x[c(1:4,6,9)]))
K36m$MPAL<-apply(as.data.frame(t(t(K36m.counts)-apply(K36m.counts, 2, min))), 1, function(x) max(x[c(5,12)]))
K36m$CD34<-apply(as.data.frame(t(t(K36m.counts)-apply(K36m.counts, 2, min))), 1, function(x) max(x[c(7)]))
K36m.all<-ggplot(K36m, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K36m.aml<-ggplot(K36m, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K36m.mpal<-ggplot(K36m, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K36m.cd34<-ggplot(K36m, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K36m.cluster<-ggplot(K36m, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K36m_ALL_tsne_210607.pdf", K36m.all, width=7.5, height=7)
ggsave("K36m_AML_tsne_210607.pdf", K36m.aml, width=7.5, height=7)
ggsave("K36m_MPAL_tsne_210607.pdf", K36m.mpal, width=7.5, height=7)
ggsave("K36m_CD34_tsne_210607.pdf", K36m.cd34, width=7.5, height=7)
ggsave("K36m_clusters_tsne_210607.pdf", K36m.cluster, width=7.5, height=7)
K9m<-read.table("K9m3.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K9m.data<-read.table("K9m3.regions.bed_counts.bed.normalized.bed", header=TRUE)
K9m.counts<-K9m.data[,c(4:ncol(K9m.data))]
K9m$cluster<-factor(K9m$cluster)
K9m$ALL<-apply(as.data.frame(t(t(K9m.counts)-apply(K9m.counts, 2, min))), 1, function(x) max(x[c(8,10:11,13)]))
K9m$AML<-apply(as.data.frame(t(t(K9m.counts)-apply(K9m.counts, 2, min))), 1, function(x) max(x[c(1:4,6,9)]))
K9m$MPAL<-apply(as.data.frame(t(t(K9m.counts)-apply(K9m.counts, 2, min))), 1, function(x) max(x[c(5,12)]))
K9m$CD34<-apply(as.data.frame(t(t(K9m.counts)-apply(K9m.counts, 2, min))), 1, function(x) max(x[c(7)]))
K9m.all<-ggplot(K9m, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K9m.aml<-ggplot(K9m, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K9m.mpal<-ggplot(K9m, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K9m.cd34<-ggplot(K9m, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K9m.cluster<-ggplot(K9m, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K9m_ALL_tsne_210607.pdf", K9m.all, width=7.5, height=7)
ggsave("K9m_AML_tsne_210607.pdf", K9m.aml, width=7.5, height=7)
ggsave("K9m_MPAL_tsne_210607.pdf", K9m.mpal, width=7.5, height=7)
ggsave("K9m_CD34_tsne_210607.pdf", K9m.cd34, width=7.5, height=7)
ggsave("K9m_clusters_tsne_210607.pdf", K9m.cluster, width=7.5, height=7)
K16ac<-read.table("K16ac.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
K16ac.data<-read.table("K16ac.regions.bed_counts.bed.normalized.bed", header=TRUE)
K16ac.counts<-K16ac.data[,c(4:ncol(K16ac.data))]
K16ac$cluster<-factor(K16ac$cluster)
K16ac$ALL<-apply(as.data.frame(t(t(K16ac.counts)-apply(K16ac.counts, 2, min))), 1, function(x) max(x[c(8:10,12)]))
K16ac$AML<-apply(as.data.frame(t(t(K16ac.counts)-apply(K16ac.counts, 2, min))), 1, function(x) max(x[c(1:4,6)]))
K16ac$MPAL<-apply(as.data.frame(t(t(K16ac.counts)-apply(K16ac.counts, 2, min))), 1, function(x) max(x[c(5,11)]))
K16ac$CD34<-apply(as.data.frame(t(t(K16ac.counts)-apply(K16ac.counts, 2, min))), 1, function(x) max(x[c(7)]))
K16ac.all<-ggplot(K16ac, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K16ac.aml<-ggplot(K16ac, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K16ac.mpal<-ggplot(K16ac, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K16ac.cd34<-ggplot(K16ac, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
K16ac.cluster<-ggplot(K16ac, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("K16ac_ALL_tsne_210607.pdf", K16ac.all, width=7.5, height=7)
ggsave("K16ac_AML_tsne_210607.pdf", K16ac.aml, width=7.5, height=7)
ggsave("K16ac_MPAL_tsne_210607.pdf", K16ac.mpal, width=7.5, height=7)
ggsave("K16ac_CD34_tsne_210607.pdf", K16ac.cd34, width=7.5, height=7)
ggsave("K16ac_clusters_tsne_210607.pdf", K16ac.cluster, width=7.5, height=7)
Pol2S5<-read.table("bedfiles/DJ_MLL/DAlChrE_noK562_plusnewdata_210215/Pol2S5.regions.bed_counts.bed.tsne_clust_clusters.bed", header=TRUE)
Pol2S5.data<-read.table("bedfiles/DJ_MLL/DAlChrE_noK562_plusnewdata_210215/Pol2S5.regions.bed_counts.bed.normalized.bed", header=TRUE)
Pol2S5.counts<-Pol2S5.data[,c(4:ncol(Pol2S5.data))]
Pol2S5$cluster<-factor(Pol2S5$cluster)
Pol2S5$ALL<-apply(as.data.frame(t(t(Pol2S5.counts)-apply(Pol2S5.counts, 2, min))), 1, function(x) max(x[c(6:8,10)]))
Pol2S5$AML<-apply(as.data.frame(t(t(Pol2S5.counts)-apply(Pol2S5.counts, 2, min))), 1, function(x) max(x[c(1:2,4)]))
Pol2S5$MPAL<-apply(as.data.frame(t(t(Pol2S5.counts)-apply(Pol2S5.counts, 2, min))), 1, function(x) max(x[c(3,9)]))
Pol2S5$CD34<-apply(as.data.frame(t(t(Pol2S5.counts)-apply(Pol2S5.counts, 2, min))), 1, function(x) max(x[c(5)]))
Pol2S5.all<-ggplot(Pol2S5, aes(x=tsne1, y=tsne2, color=ALL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
Pol2S5.aml<-ggplot(Pol2S5, aes(x=tsne1, y=tsne2, color=AML)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
Pol2S5.mpal<-ggplot(Pol2S5, aes(x=tsne1, y=tsne2, color=MPAL)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
Pol2S5.cd34<-ggplot(Pol2S5, aes(x=tsne1, y=tsne2, color=CD34)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + scale_color_gradientn(colors=c("blue", "blue", "dodgerblue", "grey70", "orange", "red", "red")) + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
Pol2S5.cluster<-ggplot(Pol2S5, aes(x=tsne1, y=tsne2, color=cluster)) + geom_point(size=0.2, pch=16) + theme_classic() + xlab("t-SNE 1") + ylab("t-SNE 2") + theme(legend.position="none") + theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(), axis.text=element_text(size=14, face="bold"), axis.title=element_text(size=16), legend.text=element_text(size=12), legend.title=element_text(size=14), axis.line=element_line(size=2))
ggsave("Pol2S5_ALL_tsne_210607.pdf", Pol2S5.all, width=7.5, height=7)
ggsave("Pol2S5_AML_tsne_210607.pdf", Pol2S5.aml, width=7.5, height=7)
ggsave("Pol2S5_MPAL_tsne_210607.pdf", Pol2S5.mpal, width=7.5, height=7)
ggsave("Pol2S5_CD34_tsne_210607.pdf", Pol2S5.cd34, width=7.5, height=7)
ggsave("Pol2S5_clusters_tsne_210607.pdf", Pol2S5.cluster, width=7.5, height=7)
